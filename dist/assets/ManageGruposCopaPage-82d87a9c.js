import{r as v,a as e,F,o as u,j as c,T as j,aF as E,B as y,aD as _,au as R,I as H,aL as O,ay as L,bn as z,aG as U,bo as Q,aH as J}from"./index-e0ec8746.js";import{C as K}from"./useSupenseQuery-df6877ce.js";import{h as X}from"./EquipoRepository-3ef6feef.js";import{d as Y,u as Z}from"./CampeonatoRepository-ce2c759f.js";import{I as S}from"./Image-07734c82.js";import{r as ee,i as ae,c as te,A as se,a as ne,d as re,b as le}from"./ExpandMore-f2db7532.js";import{G as N}from"./Grid-e8368c00.js";import{S as M}from"./Select-1cf546fd.js";import{F as ie}from"./FormControl-e0285977.js";import{C as oe}from"./Card-76798bab.js";import"./JugadoresRepository-0cb78d17.js";import"./CategoriaRepository-776d4995.js";var D={},ce=ae;Object.defineProperty(D,"__esModule",{value:!0});var k=D.default=void 0,de=ce(ee()),ue=te,me=(0,de.default)((0,ue.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");k=D.default=me;function pe(s){return s.flatMap(d=>d.partidos.map(r=>({dateNumber:d.id,homeTeamId:r.equipoLocal.id,awayTeamId:r.equipoVisitante.id})))}const he=({equipos:s,fechas:d,exists:r=!1})=>{const[l,x]=v.useState(!1),i=v.useRef(),[f,m]=v.useState(!1),b=o=>(h,g)=>{x(g?o:!1)};return e(F,{children:e(u,{className:"w-full py-4 px-2",children:d.map((o,h)=>c(se,{expanded:l===h,onChange:b(h),children:[e(ne,{expandIcon:e(re,{}),children:e(u,{className:"w-full flex justify-between items-center pr-10",children:e(j,{children:o.title})})}),e(le,{className:"flex flex-col gap-4",children:o.partidos.map((g,q)=>c(N,{container:!0,className:"flex items-center justify-center gap-2",children:[e(N,{item:!0,xs:r?4:5,children:e(M,{fullWidth:!0,defaultValue:g.equipoLocal.id,disabled:r,children:s.map(p=>e(E,{value:p.id,children:c(u,{className:"flex items-center gap-2",children:[e(u,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:p.logoUrl,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:p.name})]})},p.id))})}),e(j,{children:"VS"}),e(N,{item:!0,xs:r?4:5,children:e(M,{fullWidth:!0,defaultValue:g.equipoVisitante.id,disabled:r,children:s.map(p=>e(E,{value:p.id,children:c(u,{className:"flex items-center gap-2",children:[e(u,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:p.logoUrl,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:p.name})]})},p.id))})}),r&&e(N,{item:!0,xs:3,className:"flex gap-2 justify-end",children:e(y,{variant:"contained",onClick:()=>{i.current={dateNumber:h,homeTeam:g.equipoLocal,awayTeam:g.equipoVisitante},m(!0)},children:"Editar"})})]},q))})]},h))})})},fe=s=>{const[d,r]=v.useState([]);v.useEffect(()=>{s.length>0&&l()},[s]);const l=()=>{const x=[];s.forEach((i,f)=>{const m=[...i.equipos],b=m.length;for(let o=0;o<b-1;o++){const h=[];for(let q=0;q<b/2;q++){const p=m[q],G=m[b-1-q];h.push({id:`${f}-${o}-${q}`,equipoLocal:p,equipoVisitante:G})}x.push({id:o+1,title:`Fecha ${o+1}`,groupId:f,partidos:h});const g=m.pop();g&&m.splice(1,0,g)}}),r(x)};return{fechas:d}},ge=["2","3","4","6","8","12","16"],I=Array.from({length:18},(s,d)=>(d+1).toString()),xe=({equipos:s})=>{const d=ge.filter(a=>s.length%Number(a)===0),{id:r}=_(),[l,x]=v.useState(d[0]),i=Y(),f=R(),[m,b]=v.useState(I.map((a,t)=>({id:t,label:a,equipos:[]}))),[o,h]=v.useState(null),[g,q]=v.useState(!1),p=a=>{const t=a.target.value;x(t);const n=I.slice(0,parseInt(t)).map((C,A)=>({id:A,label:C,equipos:[]}));b(n),h(null)},G=a=>{o&&(b(t=>t.map(n=>n.id===a?{...n,equipos:[...n.equipos,o]}:n)),h(null))},V=(a,t)=>{b(n=>n.map(C=>C.id===a?{...C,equipos:C.equipos.filter(A=>A!==t)}:C))},w=a=>m.some(t=>t.equipos.includes(a)),T=a=>{const t=m.find(n=>n.id===a);return t?t.equipos.length===s.length/Number(l):!1},$=()=>{const a=I.slice(0,parseInt(l)).map((n,C)=>({id:C,label:n,equipos:[]})),t=[...s];for(;t.length>0;)for(let n=0;n<parseInt(l)&&t.length!==0;n++){const C=t.splice(Math.floor(Math.random()*t.length),1)[0];a[n].equipos.push(C)}b(a)},P=()=>{q(!0)},W=async a=>{await i.mutateAsync({campeonatoId:r||"",grupos:a}),O("Fase creada correctamente",{variant:"success"}),f(L.dashboard.campeonatos.manage(r||""))},B=()=>{const a=s.length/Number(l);return m.every(t=>t.equipos.length===a)};return c(F,{children:[c(N,{container:!0,className:"p-6",gap:4,children:[e(N,{item:!0,xs:12,className:"grid grid-cols-8 gap-6 ",children:s.map(a=>c(u,{className:"flex flex-col gap-1 items-center",children:[e(S,{src:a.logo,className:`w-10 h-10 rounded-full bg-gray-100 cursor-pointer ${w(a)?"cursor-not-allowed opacity-50":o===a?"border-4 border-blue-500 ":""}`,onClick:()=>!w(a)&&h(a)}),w(a)&&e("p",{className:"text-red-500 text-xs",children:"Asignado"})]},a.id))}),c(N,{item:!0,xs:12,className:"flex justify-between w-full items-center",children:[c(u,{className:"flex flex-col justify-center gap-2",children:[e("p",{children:"Cantidad de grupos"}),e(ie,{fullWidth:!0,children:e(M,{value:l,onChange:p,children:d.map(a=>e(E,{value:a,children:a},a))})})]}),e(u,{children:e(y,{variant:"contained",onClick:$,children:"Autocompletar al azar"})})]}),e(N,{container:!0,spacing:2,children:m.map(a=>parseInt(l)>=a.id+1&&e(N,{item:!0,xs:12/parseInt(l),children:c(u,{className:"flex flex-col p-4 border rounded-xl gap-4",children:[c("h3",{className:"font-bold text-xl text-center",children:["Grupo ",a.label]}),e("ul",{className:"flex flex-col gap-3",children:a.equipos.map((t,n)=>c("li",{className:"flex items-center justify-between w-full",children:[e(u,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:t.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1 ",style:{whiteSpace:"nowrap"},children:t.name}),e(H,{onClick:()=>V(a.id,t),color:"secondary",children:e(k,{})})]},n))}),e(y,{fullWidth:!0,variant:"contained",onClick:()=>G(a.id),disabled:!o||w(o)||T(a.id),children:"Agregar equipo"})]})},a.id))}),e(N,{item:!0,xs:12,className:"flex justify-center",children:e(y,{variant:"contained",onClick:P,fullWidth:!0,sx:{p:2},disabled:!B(),children:"Guardar Grupos"})})]}),e(be,{grupos:m,enabled:g,handleSaveFechas:W})]})},be=({grupos:s,enabled:d=!1,handleSaveFechas:r})=>{const{fechas:l}=fe(s),x=s.map(i=>({name:i.label,teamsIds:i.equipos.map(f=>f.id),matches:pe(l.filter(f=>f.groupId===i.id))}));return d?c(F,{children:[s.map(i=>c(u,{className:"flex flex-col gap-2 ",children:[e(u,{className:"flex bg-slate-100 rounded-sm w-full items-center justify-center",children:c(j,{variant:"h6",sx:{color:"black"},children:["Fixture - Grupo ",i.label]})}),e(he,{equipos:i.equipos,fechas:l.filter(f=>f.groupId===i.id)},i.id)]})),e(u,{children:e(y,{variant:"contained",onClick:()=>r(x),fullWidth:!0,sx:{p:2},children:"Guardar Fixture"})})]}):null},Ee=()=>{const s=_(),{themeStretch:d}=z();U();const{data:r,isLoading:l}=Z(s.idCampeonato||""),{data:x,isLoading:i}=X(s.idCampeonato||"");return l||i?e(Q,{}):e(F,{children:c(J,{maxWidth:d?!1:"lg",children:[e(K,{heading:`${r.name} - Fase de grupos`,links:[{name:"Listado",href:L.dashboard.campeonatos.list},{name:"Administrar",href:L.dashboard.campeonatos.manage(s.idCampeonato||"")},{name:"Fase de grupos"}]}),e(oe,{children:e(xe,{equipos:x.teams||[]})})]})})};export{Ee as default};
