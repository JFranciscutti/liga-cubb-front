import{r as w,j as d,F as B,a as e,o as f,T as N,aF as b,B as L,aD as P,aw as k,W as T,aH as W,q as A,aL as D}from"./index-7564c5a3.js";import{C as H}from"./useSupenseQuery-2f1fe18d.js";import{A as O,a as _,d as I,b as R}from"./ExpandMore-c12eba82.js";import{I as q}from"./Image-6bd31657.js";import{E as z}from"./EditMatchModal-8e03a12d.js";import{C as V}from"./Card-33a9d174.js";import{G as j}from"./Grid-e2d030a2.js";import{S as M}from"./Select-801e906b.js";import{e as J}from"./CategoriaRepository-7eb5d34c.js";import{a as K}from"./EquipoRepository-b3f38c97.js";import"./styles-3f44635e.js";import"./DialogHeader-b66d443c.js";import"./canchas-f9c46237.js";import"./KeyboardArrowRight-15df010f.js";import"./InputAdornment-1d356a85.js";import"./compressor.esm-bc452357.js";import"./HitNumberField-dd450b14.js";import"./HitSelectField-dd9c2783.js";import"./HitTextField-1715ae1e.js";import"./enums-ec95615b.js";import"./JugadoresRepository-8e4c7c21.js";const Q=s=>{const[C,g]=w.useState([]),h=s.length,m=h-1,S=h/2,F=(a,u,p)=>{const l=[];for(let r=0;r<h;r++)for(let i=r+1;i<h;i++){const n=`${a[r].id}-${a[i].id}`,t=`${a[i].id}-${a[r].id}`;if(!u.has(n)&&!u.has(t)&&!p.has(a[r].id)&&!p.has(a[i].id)&&(l.push({equipoLocal:a[r],equipoVisitante:a[i]}),u.add(n),u.add(t),p.add(a[r].id),p.add(a[i].id),l.length>=S))return l}return l};return{handleAutocompletar:()=>{const a=new Set,u=Array.from({length:m},(p,l)=>{const i=F(s,a,new Set);return{id:l+1,title:`Fecha ${l+1}`,partidos:i}});g(u)},fechas:C}},U=({equipos:s,handleSave:C})=>{const{fechas:g,handleAutocompletar:h}=Q(s),[m,S]=w.useState([]),[F,v]=w.useState(!1),a=w.useRef(),[u,p]=w.useState(!1);w.useEffect(()=>{S(g)},[g]),console.log(m);const l=n=>(t,o)=>{v(o?n:!1)},r=(n,t,o)=>y=>{console.log(n,t,o),S(c=>c.map((E,$)=>$!==n?E:{...E,partidos:E.partidos.map((x,G)=>G!==t?x:{...x,equipoLocal:o==="home"?{...x.equipoLocal,id:y.target.value}:x.equipoLocal,equipoVisitante:o==="away"?{...x.equipoVisitante,id:y.target.value}:x.equipoVisitante})}))};function i(n){return n.flatMap(t=>t.partidos.map(o=>({dateNumber:t.id,homeTeamId:o.equipoLocal.id,awayTeamId:o.equipoVisitante.id})))}return d(B,{children:[d(V,{className:"w-full py-4 px-2",children:[m.map((n,t)=>d(O,{expanded:F===t,onChange:l(t),children:[e(_,{expandIcon:e(I,{}),children:e(f,{className:"w-full flex justify-between items-center pr-10",children:e(N,{children:n.title})})}),e(R,{className:"flex flex-col gap-4",children:n.partidos.map((o,y)=>d(j,{container:!0,className:"flex items-center justify-center gap-2",children:[e(j,{item:!0,xs:5,children:e(M,{fullWidth:!0,value:o.equipoLocal.id,onChange:r(t,y,"home"),children:s.map(c=>e(b,{value:c.id,children:d(f,{className:"flex items-center gap-2",children:[e(f,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(q,{src:c.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:c.name})]})},c.id))})}),e(N,{children:"VS"}),e(j,{item:!0,xs:5,children:e(M,{fullWidth:!0,value:o.equipoVisitante.id,onChange:r(t,y,"away"),children:s.map(c=>e(b,{value:c.id,children:d(f,{className:"flex items-center gap-2",children:[e(f,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(q,{src:c.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:c.name})]})},c.id))})})]},y))})]},t)),m.length===0&&d(f,{className:"flex flex-col p-4 items-center justify-center gap-5",children:[e(N,{children:"Esta categoría aún no tiene fechas creadas."}),e(L,{variant:"contained",onClick:h,children:"Autocompletar equipos"})]}),e(f,{className:"flex w-full mt-2 justify-end",children:e(L,{variant:"contained",disabled:m.length===0,onClick:()=>C(i(m)),children:"Guardar fechas"})})]}),e(z,{open:u,match:a.current,handleClose:()=>{p(!1),a.current=void 0},handleSave:()=>{}})]})},X=U;function we(){const s=P(),C=k(),{data:g,isLoading:h,isError:m,refetch:S}=K(s.id||""),F=J(),v=async a=>{await F.mutateAsync({fechas:a,categoryId:s.id||""}),D({message:"Fase creada con éxito",variant:"success"}),C(A.dashboard.categorias.edit(s.id||""))};return d(B,{children:[e(T,{children:e("title",{children:"Equipos | LIGA CUBB"})}),d(W,{children:[e(H,{heading:"Fixture - Categoria",links:[{name:"Listado",href:A.dashboard.categorias.list},{name:"Administrar",href:A.dashboard.categorias.edit(s.id||"")},{name:"Fixture"}]}),e(V,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e(X,{equipos:g.teams||[],handleSave:v})})]})]})}export{we as default};
