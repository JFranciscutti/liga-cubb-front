import{r as C,j as i,F,a as e,o as m,T as E,aF as j,B as w,aD as _,aw as R,I as H,aL as O,q as M,bn as z,aG as U,bo as Q,aH as J}from"./index-7564c5a3.js";import{C as K}from"./useSupenseQuery-2f1fe18d.js";import{h as X}from"./EquipoRepository-b3f38c97.js";import{d as Y,u as Z}from"./CampeonatoRepository-1824db64.js";import{I as S}from"./Image-6bd31657.js";import{r as ee,i as ae,c as te,A as se,a as ne,d as re,b as ie}from"./ExpandMore-c12eba82.js";import{E as le}from"./EditMatchModal-8e03a12d.js";import{G as v}from"./Grid-e2d030a2.js";import{S as L,F as oe}from"./Select-801e906b.js";import{C as ce}from"./Card-33a9d174.js";import"./enums-ec95615b.js";import"./JugadoresRepository-8e4c7c21.js";import"./styles-3f44635e.js";import"./CategoriaRepository-7eb5d34c.js";import"./DialogHeader-b66d443c.js";import"./canchas-f9c46237.js";import"./KeyboardArrowRight-15df010f.js";import"./InputAdornment-1d356a85.js";import"./compressor.esm-bc452357.js";import"./HitNumberField-dd450b14.js";import"./HitSelectField-dd9c2783.js";import"./HitTextField-1715ae1e.js";var D={},de=ae;Object.defineProperty(D,"__esModule",{value:!0});var k=D.default=void 0,ue=de(ee()),me=te,pe=(0,ue.default)((0,me.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");k=D.default=pe;function he(s){return s.flatMap(d=>d.partidos.map(l=>({dateNumber:d.id,homeTeamId:l.equipoLocal.id,awayTeamId:l.equipoVisitante.id})))}const fe=({equipos:s,fechas:d,exists:l=!1})=>{const[o,x]=C.useState(!1),n=C.useRef(),[h,u]=C.useState(!1),b=c=>(f,g)=>{x(g?c:!1)};return i(F,{children:[e(m,{className:"w-full py-4 px-2",children:d.map((c,f)=>i(se,{expanded:o===f,onChange:b(f),children:[e(ne,{expandIcon:e(re,{}),children:e(m,{className:"w-full flex justify-between items-center pr-10",children:e(E,{children:c.title})})}),e(ie,{className:"flex flex-col gap-4",children:c.partidos.map((g,N)=>i(v,{container:!0,className:"flex items-center justify-center gap-2",children:[e(v,{item:!0,xs:l?4:5,children:e(L,{fullWidth:!0,defaultValue:g.equipoLocal.id,disabled:l,children:s.map(p=>e(j,{value:p.id,children:i(m,{className:"flex items-center gap-2",children:[e(m,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:p.logoUrl,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:p.name})]})},p.id))})}),e(E,{children:"VS"}),e(v,{item:!0,xs:l?4:5,children:e(L,{fullWidth:!0,defaultValue:g.equipoVisitante.id,disabled:l,children:s.map(p=>e(j,{value:p.id,children:i(m,{className:"flex items-center gap-2",children:[e(m,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:p.logoUrl,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:p.name})]})},p.id))})}),l&&i(v,{item:!0,xs:3,className:"flex gap-2 justify-end",children:[e(w,{variant:"contained",onClick:()=>{n.current={dateNumber:f,homeTeam:g.equipoLocal,awayTeam:g.equipoVisitante},u(!0)},children:"Editar"}),e(w,{variant:"contained",children:"Ver"})]})]},N))})]},f))}),e(le,{open:h,match:n.current,handleClose:()=>{u(!1),n.current=void 0},handleSave:()=>{}})]})},ge=s=>{const[d,l]=C.useState([]);C.useEffect(()=>{s.length>0&&o()},[s]);const o=()=>{const x=[];s.forEach((n,h)=>{const u=[...n.equipos],b=u.length;for(let c=0;c<b-1;c++){const f=[];for(let N=0;N<b/2;N++){const p=u[N],G=u[b-1-N];f.push({id:`${h}-${c}-${N}`,equipoLocal:p,equipoVisitante:G})}x.push({id:c+1,title:`Fecha ${c+1}`,groupId:h,partidos:f});const g=u.pop();g&&u.splice(1,0,g)}}),l(x)};return{fechas:d}},xe=["2","3","4","6","8","12","16"],I=Array.from({length:18},(s,d)=>(d+1).toString()),be=({equipos:s})=>{const d=xe.filter(a=>s.length%Number(a)===0),{id:l}=_(),[o,x]=C.useState(d[0]),n=Y(),h=R(),[u,b]=C.useState(I.map((a,t)=>({id:t,label:a,equipos:[]}))),[c,f]=C.useState(null),[g,N]=C.useState(!1),p=a=>{const t=a.target.value;x(t);const r=I.slice(0,parseInt(t)).map((q,A)=>({id:A,label:q,equipos:[]}));b(r),f(null)},G=a=>{c&&(b(t=>t.map(r=>r.id===a?{...r,equipos:[...r.equipos,c]}:r)),f(null))},V=(a,t)=>{b(r=>r.map(q=>q.id===a?{...q,equipos:q.equipos.filter(A=>A!==t)}:q))},y=a=>u.some(t=>t.equipos.includes(a)),T=a=>{const t=u.find(r=>r.id===a);return t?t.equipos.length===s.length/Number(o):!1},$=()=>{const a=I.slice(0,parseInt(o)).map((r,q)=>({id:q,label:r,equipos:[]})),t=[...s];for(;t.length>0;)for(let r=0;r<parseInt(o)&&t.length!==0;r++){const q=t.splice(Math.floor(Math.random()*t.length),1)[0];a[r].equipos.push(q)}b(a)},P=()=>{N(!0)},W=async a=>{await n.mutateAsync({campeonatoId:l||"",grupos:a}),O("Fase creada correctamente",{variant:"success"}),h(M.dashboard.campeonatos.manage(l||""))},B=()=>{const a=s.length/Number(o);return u.every(t=>t.equipos.length===a)};return i(F,{children:[i(v,{container:!0,className:"p-6",gap:4,children:[e(v,{item:!0,xs:12,className:"grid grid-cols-8 gap-6 ",children:s.map(a=>i(m,{className:"flex flex-col gap-1 items-center",children:[e(S,{src:a.logo,className:`w-10 h-10 rounded-full bg-gray-100 cursor-pointer ${y(a)?"cursor-not-allowed opacity-50":c===a?"border-4 border-blue-500 ":""}`,onClick:()=>!y(a)&&f(a)}),y(a)&&e("p",{className:"text-red-500 text-xs",children:"Asignado"})]},a.id))}),i(v,{item:!0,xs:12,className:"flex justify-between w-full items-center",children:[i(m,{className:"flex flex-col justify-center gap-2",children:[e("p",{children:"Cantidad de grupos"}),e(oe,{fullWidth:!0,children:e(L,{value:o,onChange:p,children:d.map(a=>e(j,{value:a,children:a},a))})})]}),e(m,{children:e(w,{variant:"contained",onClick:$,children:"Autocompletar al azar"})})]}),e(v,{container:!0,spacing:2,children:u.map(a=>parseInt(o)>=a.id+1&&e(v,{item:!0,xs:12/parseInt(o),children:i(m,{className:"flex flex-col p-4 border rounded-xl gap-4",children:[i("h3",{className:"font-bold text-xl text-center",children:["Grupo ",a.label]}),e("ul",{className:"flex flex-col gap-3",children:a.equipos.map((t,r)=>i("li",{className:"flex items-center justify-between w-full",children:[e(m,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(S,{src:t.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1 ",style:{whiteSpace:"nowrap"},children:t.name}),e(H,{onClick:()=>V(a.id,t),color:"secondary",children:e(k,{})})]},r))}),e(w,{fullWidth:!0,variant:"contained",onClick:()=>G(a.id),disabled:!c||y(c)||T(a.id),children:"Agregar equipo"})]})},a.id))}),e(v,{item:!0,xs:12,className:"flex justify-center",children:e(w,{variant:"contained",onClick:P,fullWidth:!0,sx:{p:2},disabled:!B(),children:"Guardar Grupos"})})]}),e(qe,{grupos:u,enabled:g,handleSaveFechas:W})]})},qe=({grupos:s,enabled:d=!1,handleSaveFechas:l})=>{const{fechas:o}=ge(s),x=s.map(n=>({name:n.label,teamsIds:n.equipos.map(h=>h.id),matches:he(o.filter(h=>h.groupId===n.id))}));return d?i(F,{children:[s.map(n=>i(m,{className:"flex flex-col gap-2 ",children:[e(m,{className:"flex bg-slate-100 rounded-sm w-full items-center justify-center",children:i(E,{variant:"h6",sx:{color:"black"},children:["Fixture - Grupo ",n.label]})}),e(fe,{equipos:n.equipos,fechas:o.filter(h=>h.groupId===n.id)},n.id)]})),e(m,{children:e(w,{variant:"contained",onClick:()=>l(x),fullWidth:!0,sx:{p:2},children:"Guardar Fixture"})})]}):null},Be=()=>{const s=_(),{themeStretch:d}=z();U();const{data:l,isLoading:o}=Z(localStorage.getItem("idCampeonato")||""),{data:x,isLoading:n}=X(s.id||"");return o||n?e(Q,{}):e(F,{children:i(J,{maxWidth:d?!1:"lg",children:[e(K,{heading:`${l.name} - Fase de grupos`,links:[{name:"Listado",href:M.dashboard.categorias.list},{name:"Administrar",href:M.dashboard.campeonatos.manage(s.id||"")},{name:"Fase de grupos"}]}),e(ce,{children:e(be,{equipos:x.teams||[]})})]})})};export{Be as default};
