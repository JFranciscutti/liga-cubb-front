import{r as w,a as e,F as L,j as l,o as h,T as N,aF as v,B as j,aD as $,au as G,W as P,aH as k,ay as S,aL as M}from"./index-e0ec8746.js";import{C as T}from"./useSupenseQuery-df6877ce.js";import{A as W,a as D,d as H,b as _}from"./ExpandMore-f2db7532.js";import{I as E}from"./Image-07734c82.js";import{C as q}from"./Card-76798bab.js";import{G as A}from"./Grid-e8368c00.js";import{S as b}from"./Select-1cf546fd.js";import{e as I}from"./CategoriaRepository-776d4995.js";import{a as z}from"./EquipoRepository-3ef6feef.js";import"./JugadoresRepository-0cb78d17.js";const J=i=>{const[g,p]=w.useState([]),d=i.length,m=d-1,C=d/2,y=(s,c,u)=>{const n=[];for(let a=0;a<d;a++)for(let t=a+1;t<d;t++){const o=`${s[a].id}-${s[t].id}`,r=`${s[t].id}-${s[a].id}`;if(!c.has(o)&&!c.has(r)&&!u.has(s[a].id)&&!u.has(s[t].id)&&(n.push({equipoLocal:s[a],equipoVisitante:s[t]}),c.add(o),c.add(r),u.add(s[a].id),u.add(s[t].id),n.length>=C))return n}return n};return{handleAutocompletar:()=>{const s=new Set,c=Array.from({length:m},(u,n)=>{const t=y(i,s,new Set);return{id:n+1,title:`Fecha ${n+1}`,partidos:t}});p(c)},fechas:g}},K=({equipos:i,handleSave:g})=>{const{fechas:p,handleAutocompletar:d}=J(i),[m,C]=w.useState([]),[y,x]=w.useState(!1);w.useEffect(()=>{C(p)},[p]);const s=n=>(a,t)=>{x(t?n:!1)},c=(n,a,t)=>o=>{console.log(n,a,t),C(r=>r.map((F,B)=>B!==n?F:{...F,partidos:F.partidos.map((f,V)=>V!==a?f:{...f,equipoLocal:t==="home"?{...f.equipoLocal,id:o.target.value}:f.equipoLocal,equipoVisitante:t==="away"?{...f.equipoVisitante,id:o.target.value}:f.equipoVisitante})}))};function u(n){return n.flatMap(a=>a.partidos.map(t=>({dateNumber:a.id,homeTeamId:t.equipoLocal.id,awayTeamId:t.equipoVisitante.id})))}return e(L,{children:l(q,{className:"w-full py-4 px-2",children:[m.map((n,a)=>l(W,{expanded:y===a,onChange:s(a),children:[e(D,{expandIcon:e(H,{}),children:e(h,{className:"w-full flex justify-between items-center pr-10",children:e(N,{children:n.title})})}),e(_,{className:"flex flex-col gap-4",children:n.partidos.map((t,o)=>l(A,{container:!0,className:"flex items-center justify-center gap-2",children:[e(A,{item:!0,xs:5,children:e(b,{fullWidth:!0,value:t.equipoLocal.id,onChange:c(a,o,"home"),children:i.map(r=>e(v,{value:r.id,children:l(h,{className:"flex items-center gap-2",children:[e(h,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(E,{src:r.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:r.name})]})},r.id))})}),e(N,{children:"VS"}),e(A,{item:!0,xs:5,children:e(b,{fullWidth:!0,value:t.equipoVisitante.id,onChange:c(a,o,"away"),children:i.map(r=>e(v,{value:r.id,children:l(h,{className:"flex items-center gap-2",children:[e(h,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(E,{src:r.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:r.name})]})},r.id))})})]},o))})]},a)),m.length===0&&l(h,{className:"flex flex-col p-4 items-center justify-center gap-5",children:[e(N,{children:"Esta categoría aún no tiene fechas creadas."}),e(j,{variant:"contained",onClick:d,children:"Autocompletar equipos"})]}),e(h,{className:"flex w-full mt-2 justify-end",children:e(j,{variant:"contained",disabled:m.length===0,onClick:()=>g(u(m)),children:"Guardar fechas"})})]})})},O=K;function se(){const i=$(),g=G(),{data:p,isLoading:d,isError:m,refetch:C}=z(i.idCategoria||""),y=I(),x=async s=>{await y.mutateAsync({fechas:s,categoryId:i.idCategoria||""}),M({message:"Fase creada con éxito",variant:"success"}),g(S.dashboard.categorias.edit(i.idCategoria||""))};return l(L,{children:[e(P,{children:e("title",{children:"Equipos | LIGA CUBB"})}),l(k,{children:[e(T,{heading:"Fixture - Categoria",links:[{name:"Listado",href:S.dashboard.campeonatos.manage(i.idCampeonato||"")},{name:"Administrar",href:S.dashboard.campeonatos.manageCategoria(i.idCampeonato||"",i.idCategoria||"")},{name:"Fixture"}]}),e(q,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e(O,{equipos:p.teams||[],handleSave:x})})]})]})}export{se as default};
