import{r as w,j as d,F as B,a as e,o as f,T as N,aE as j,B as q,bl as P,aw as k,W as T,aG as W,q as A,bn as O}from"./index-c23903f8.js";import{C as _}from"./CustomBreadcrumbs-a5dcf113.js";import{A as D,a as H,d as I,b as R}from"./ExpandMore-65be29e9.js";import{I as L}from"./Image-dd45a27b.js";import{E as z}from"./EditMatchModal-7be0830c.js";import{C as V}from"./Card-9f0c7488.js";import{G as b}from"./Grid-e20c1929.js";import{S as M}from"./Select-2d9d323e.js";import{e as J}from"./CategoriaRepository-204dc213.js";import{a as K}from"./EquipoRepository-600107ee.js";import"./yup-5bc9912e.js";import"./styles-bb773ccc.js";import"./DialogHeader-eae97665.js";import"./HitMultiSelectField-54314fa9.js";import"./KeyboardArrowRight-cc03e53f.js";import"./Chip-98127efc.js";import"./InputAdornment-742361d8.js";import"./compressor.esm-3ab290a9.js";import"./HitNumberField-bc972176.js";import"./HitSelectField-52ff812e.js";import"./HitTextField-48ffeaee.js";import"./enums-ec95615b.js";import"./useSupenseQuery-b777e0ff.js";import"./JugadoresRepository-576570e9.js";const Q=i=>{const[C,g]=w.useState([]),h=i.length,m=h-1,S=h/2,E=(a,u,p)=>{const l=[];for(let r=0;r<h;r++)for(let s=r+1;s<h;s++){const n=`${a[r].id}-${a[s].id}`,t=`${a[s].id}-${a[r].id}`;if(!u.has(n)&&!u.has(t)&&!p.has(a[r].id)&&!p.has(a[s].id)&&(l.push({equipoLocal:a[r],equipoVisitante:a[s]}),u.add(n),u.add(t),p.add(a[r].id),p.add(a[s].id),l.length>=S))return l}return l};return{handleAutocompletar:()=>{const a=new Set,u=Array.from({length:m},(p,l)=>{const s=E(i,a,new Set);return{id:l+1,title:`Fecha ${l+1}`,partidos:s}});g(u)},fechas:C}},U=({equipos:i,handleSave:C})=>{const{fechas:g,handleAutocompletar:h}=Q(i),[m,S]=w.useState([]),[E,F]=w.useState(!1),a=w.useRef(),[u,p]=w.useState(!1);w.useEffect(()=>{S(g)},[g]),console.log(m);const l=n=>(t,o)=>{F(o?n:!1)},r=(n,t,o)=>y=>{console.log(n,t,o),S(c=>c.map((v,G)=>G!==n?v:{...v,partidos:v.partidos.map((x,$)=>$!==t?x:{...x,equipoLocal:o==="home"?{...x.equipoLocal,id:y.target.value}:x.equipoLocal,equipoVisitante:o==="away"?{...x.equipoVisitante,id:y.target.value}:x.equipoVisitante})}))};function s(n){return n.flatMap(t=>t.partidos.map(o=>({dateNumber:t.id,homeTeamId:o.equipoLocal.id,awayTeamId:o.equipoVisitante.id})))}return d(B,{children:[d(V,{className:"w-full py-4 px-2",children:[m.map((n,t)=>d(D,{expanded:E===t,onChange:l(t),children:[e(H,{expandIcon:e(I,{}),children:e(f,{className:"w-full flex justify-between items-center pr-10",children:e(N,{children:n.title})})}),e(R,{className:"flex flex-col gap-4",children:n.partidos.map((o,y)=>d(b,{container:!0,className:"flex items-center justify-center gap-2",children:[e(b,{item:!0,xs:5,children:e(M,{fullWidth:!0,value:o.equipoLocal.id,onChange:r(t,y,"home"),children:i.map(c=>e(j,{value:c.id,children:d(f,{className:"flex items-center gap-2",children:[e(f,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(L,{src:c.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:c.name})]})},c.id))})}),e(N,{children:"VS"}),e(b,{item:!0,xs:5,children:e(M,{fullWidth:!0,value:o.equipoVisitante.id,onChange:r(t,y,"away"),children:i.map(c=>e(j,{value:c.id,children:d(f,{className:"flex items-center gap-2",children:[e(f,{className:"flex items-center justify-center h-10 min-w-10 rounded-full bg-gray-50",children:e(L,{src:c.logo,className:"h-10 w-10 min-w-10"})}),e("p",{className:"line-clamp-1",style:{whiteSpace:"nowrap"},children:c.name})]})},c.id))})})]},y))})]},t)),m.length===0&&d(f,{className:"flex flex-col p-4 items-center justify-center gap-5",children:[e(N,{children:"Esta categoría aún no tiene fechas creadas."}),e(q,{variant:"contained",onClick:h,children:"Autocompletar equipos"})]}),e(f,{className:"flex w-full mt-2 justify-end",children:e(q,{variant:"contained",disabled:m.length===0,onClick:()=>C(s(m)),children:"Guardar fechas"})})]}),e(z,{open:u,match:a.current,handleClose:()=>{p(!1),a.current=void 0},handleSave:()=>{}})]})},X=U;function Ee(){const i=P(),C=k(),{data:g,isLoading:h,isError:m,refetch:S}=K(i.id||""),E=J(),F=async a=>{await E.mutateAsync({fechas:a,categoryId:i.id||""}),O({message:"Fase creada con éxito",variant:"success"}),C(A.dashboard.categorias.edit(i.id||""))};return d(B,{children:[e(T,{children:e("title",{children:"Equipos | LIGA CUBB"})}),d(W,{children:[e(_,{heading:"Fixture - Categoria",links:[{name:"Listado",href:A.dashboard.categorias.list},{name:"Administrar",href:A.dashboard.categorias.edit(i.id||"")},{name:"Fixture"}]}),e(V,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e(X,{equipos:g.teams||[],handleSave:F})})]})]})}export{Ee as default};
